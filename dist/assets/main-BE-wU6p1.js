import{P as e,a as t}from"./p2p-Bf-SwPL_.js";import{A as n}from"./engine-CCVkibka.js";import"./peerjs-BtN9W7or.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let o=null,r=null,a="";function i(){const e=document.getElementById("app");e?(e.innerHTML='\n    <div class="container">\n      <h1>üéÆ Century: Golem Edition</h1>\n      <p class="subtitle">Peer-to-Peer Multiplayer - No Server Required</p>\n      \n      <div class="tabs">\n        <button class="tab-btn active" data-tab="create">Create Room</button>\n        <button class="tab-btn" data-tab="join">Join Room</button>\n      </div>\n      \n      <div class="tab-content active" id="create-tab">\n        <h2>Create a Game Room</h2>\n        <form id="create-form">\n          <div class="form-group">\n            <label>Number of Players:</label>\n            <input type="number" id="player-count" min="2" max="5" value="3" />\n          </div>\n          <button type="submit" class="btn-primary">Create Room</button>\n        </form>\n        <div id="room-info" style="display:none;">\n          <h3>‚úÖ Room Created!</h3>\n          <p><strong>Share these with other players:</strong></p>\n          <div style="margin: 15px 0;">\n            <label>Room Code:</label>\n            <div class="room-code" id="room-code-display"></div>\n          </div>\n          <div style="margin: 15px 0;">\n            <label>Host Peer ID:</label>\n            <div class="peer-id" id="peer-id-display"></div>\n          </div>\n          <div id="players-waiting" style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 4px;">\n            <h4>Players Connected: <span id="connected-count">1</span>/<span id="total-count">3</span></h4>\n            <div id="player-list"></div>\n            <p style="margin-top: 15px; opacity: 0.8; font-size: 0.9em;">Game will start automatically when all players join.</p>\n          </div>\n        </div>\n      </div>\n      \n      <div class="tab-content" id="join-tab">\n        <h2>Join a Game Room</h2>\n        <form id="join-form">\n          <div class="form-group">\n            <label>Room Code:</label>\n            <input type="text" id="room-code-input" placeholder="e.g., A3F9K2" />\n          </div>\n          <div class="form-group">\n            <label>Host Peer ID:</label>\n            <input type="text" id="host-peer-id-input" placeholder="Provided by host" />\n          </div>\n          <div class="form-group">\n            <label>Your Name:</label>\n            <input type="text" id="player-name-input" placeholder="Enter your name" />\n          </div>\n          <button type="submit" class="btn-primary">Join Room</button>\n        </form>\n      </div>\n      \n      <div id="game-area" style="display:none;">\n        <h2>Game in Progress</h2>\n        \n        <div id="player-identity" style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 4px;">\n          <strong>You are:</strong> <span id="your-player-name"></span>\n          <span id="host-indicator" style="margin-left: 10px; display:none;">(HOST)</span>\n        </div>\n        \n        <div id="turn-status" style="margin-bottom: 15px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 4px; font-size: 1.1em;">\n          <strong id="turn-message">Waiting...</strong>\n        </div>\n        \n        <div id="game-status" style="margin-bottom: 20px; font-size: 0.9em; opacity: 0.8;"></div>\n        \n        <div id="game-actions" style="display:flex; gap:10px; flex-wrap:wrap;">\n          <button class="btn-primary" id="action-play-card" disabled>Play Card</button>\n          <button class="btn-primary" id="action-take-merchant" disabled>Take Merchant Card</button>\n          <button class="btn-primary" id="action-claim-vp" disabled>Claim Victory Points</button>\n          <button class="btn-primary" id="action-rest" disabled>Rest (Take All Cards)</button>\n        </div>\n        \n        <div id="action-result" style="margin-top: 20px; padding: 10px; border-radius: 4px; display:none;"></div>\n      </div>\n    </div>\n  ',function(){document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-tab");t&&function(e){document.querySelectorAll(".tab-btn").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-tab="${e}"]`)?.classList.add("active"),document.querySelectorAll(".tab-content").forEach(e=>{e.classList.remove("active")}),document.getElementById(`${e}-tab`)?.classList.add("active")}(t)})});const e=document.getElementById("create-form");e?.addEventListener("submit",d);const t=document.getElementById("join-form");t?.addEventListener("submit",l),document.getElementById("action-play-card")?.addEventListener("click",()=>c("play-card")),document.getElementById("action-take-merchant")?.addEventListener("click",()=>c("take-merchant")),document.getElementById("action-claim-vp")?.addEventListener("click",()=>c("claim-vp")),document.getElementById("action-rest")?.addEventListener("click",()=>c("rest"))}()):console.error("App mount point not found")}async function d(t){t.preventDefault();const n=parseInt(document.getElementById("player-count").value),r=document.getElementById("room-info"),i=document.getElementById("room-code-display"),d=document.getElementById("peer-id-display");if(r&&i&&d)try{o=new e,o.on("room-created",({roomCode:e,hostPeerId:t,playerCount:n})=>{i.textContent=e,d.textContent=t;const o=document.getElementById("total-count");o&&(o.textContent=n.toString()),s(),r.style.display="block"}),o.on("peer-connected",({playerName:e})=>{console.log(`Player ${e} joined!`),s()}),o.on("game-state-updated",e=>{const t=document.getElementById("game-area");if(t&&"PLAYING"===e.phase){const n=document.getElementById("room-info");if(n&&(n.style.display="none"),t.style.display="block",!a){a=e.players[0].id;const t=document.getElementById("your-player-name");t&&(t.textContent=e.players[0].name);const n=document.getElementById("host-indicator");n&&(n.style.display="inline")}m(e)}}),o.on("action-processed",(e,t)=>{t?u("Action processed successfully","success"):u("Action processing failed","error")}),o.on("room-error",e=>{console.error("Room error:",e),alert(`Error: ${e.message}`)});const t=Array.from({length:n},(e,t)=>`Player ${t+1}`);await o.createRoom(t)}catch(l){console.error("Failed to create room:",l),alert(`Failed to create room: ${l.message}`)}}function s(){if(!o)return;const e=document.getElementById("player-list"),t=document.getElementById("connected-count");if(!e||!t)return;const n=o.game,r=o.playerConnections;if(!n)return;const a=new Set(Array.from(r.values()).map(e=>e.playerId));e.innerHTML=n.players.map(e=>{const t=a.has(e.id),n=t?"Connected":"Waiting...";return`<div style="padding: 5px 0;">${t?"‚úÖ":"‚è≥"} ${e.name} - ${n}</div>`}).join(""),t.textContent=a.size.toString()}async function l(e){e.preventDefault();const n=document.getElementById("room-code-input").value,o=document.getElementById("host-peer-id-input").value,i=document.getElementById("player-name-input").value;if(n&&o&&i)try{r=new t,r.on("connected",()=>{alert(`Successfully joined room ${n}!`),document.getElementById("create-tab").style.display="none",document.getElementById("join-tab").style.display="none";const e=document.getElementById("game-area");if(e){e.style.display="block";const t=document.getElementById("your-player-name");t&&(t.textContent=i)}}),r.on("disconnected",()=>{u("Disconnected from room","error")}),r.on("host-disconnected",()=>{const e=document.getElementById("game-area");e&&(e.innerHTML='\n          <h2>Game Ended</h2>\n          <p style="padding: 20px; background: rgba(244, 67, 54, 0.2); border-radius: 8px;">\n            <strong>Host disconnected.</strong><br><br>\n            The host has closed their browser or lost connection.<br>\n            The game cannot continue without the host.<br><br>\n            Please refresh to start a new game.\n          </p>\n        ')}),r.on("game-state-received",e=>{m(e)}),r.on("action-accepted",e=>{u("Action accepted! Waiting for state update...","success")}),r.on("action-rejected",(e,t)=>{u(`Action rejected: ${t}`,"error")}),r.on("error",e=>{console.error("Client error:",e),alert(`Error: ${e.message}`)}),a=`player_${Date.now()}`,await r.joinRoomWithPeerId(n,o,a,i)}catch(d){console.error("Failed to join room:",d),alert(`Failed to join room: ${d.message}`)}else alert("Please fill in all fields")}async function c(e){if(r)if(a)try{let t;switch(e){case"rest":t={type:n.Rest,playerId:a,timestamp:Date.now()};break;case"play-card":return void u("Select a card to play (UI not implemented)","error");case"take-merchant":return void u("Select a merchant card (UI not implemented)","error");case"claim-vp":return void u("Select a victory point card (UI not implemented)","error");default:return void u("Unknown action type","error")}u("Waiting for host...","info"),await r.sendAction(t)}catch(t){u(`Failed to send action: ${t.message}`,"error")}else u("Player ID not set","error");else u("Not connected to a room","error")}function m(e){const t=e.players[e.currentPlayerIndex],n=t?.id===a;e.players.find(e=>e.id===a);const o=document.getElementById("turn-message");o&&(n?(o.textContent="Your turn",o.style.color="#4caf50"):(o.textContent=`Waiting for ${t?.name||"Unknown"}`,o.style.color="#ff9800"));const r=document.getElementById("game-status");r&&(r.textContent=`Turn ${e.turnNumber} ‚Ä¢ ${e.phase} ‚Ä¢ ${e.players.length} players`);document.querySelectorAll("#game-actions button").forEach(e=>{e.disabled=!n,e.style.opacity=n?"1":"0.5",e.style.cursor=n?"pointer":"not-allowed"});const i=document.getElementById("action-result");i&&i.textContent.includes("Waiting for host")&&(i.style.display="none")}function u(e,t){const n=document.getElementById("action-result");n&&(n.textContent=e,n.style.display="block","success"===t?(n.style.backgroundColor="#4caf50",n.style.color="white"):"error"===t?(n.style.backgroundColor="#f44336",n.style.color="white"):(n.style.backgroundColor="#2196f3",n.style.color="white"),setTimeout(()=>{n&&(n.style.display="none")},5e3))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",i):i();
//# sourceMappingURL=main-BE-wU6p1.js.map
