import{P as e,a as t}from"./p2p-w8SySoKn.js";import{A as n}from"./engine-CCVkibka.js";import"./peerjs-BtN9W7or.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let o=null,a=null,r="",i=!1;function s(){const e=document.getElementById("app");e?(e.innerHTML='\n    <div class="container">\n      <h1>üéÆ Century: Golem Edition</h1>\n      <p class="subtitle">Peer-to-Peer Multiplayer - No Server Required</p>\n      \n      <div class="tabs">\n        <button class="tab-btn active" data-tab="create">Create Room</button>\n        <button class="tab-btn" data-tab="join">Join Room</button>\n      </div>\n      \n      <div class="tab-content active" id="create-tab">\n        <h2>Create a Game Room</h2>\n        <form id="create-form">\n          <div class="form-group">\n            <label>Your Name:</label>\n            <input type="text" id="host-name-input" placeholder="Enter your name" required />\n          </div>\n          <div class="form-group">\n            <label>Number of Players:</label>\n            <input type="number" id="player-count" min="2" max="5" value="3" />\n          </div>\n          <button type="submit" class="btn-primary">Create Room</button>\n        </form>\n        <div id="room-info" style="display:none;">\n          <h3>‚úÖ Room Created!</h3>\n          <p><strong>Share this Room Code with other players:</strong></p>\n          <div style="margin: 15px 0;">\n            <div class="room-code" id="room-code-display"></div>\n          </div>\n          <div id="players-waiting" style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 4px;">\n            <h4>Players Connected: <span id="connected-count">1</span>/<span id="total-count">3</span></h4>\n            <div id="player-list"></div>\n            <p style="margin-top: 15px; opacity: 0.8; font-size: 0.9em;">Game will start automatically when all players join.</p>\n          </div>\n        </div>\n      </div>\n      \n      <div class="tab-content" id="join-tab">\n        <h2>Join a Game Room</h2>\n        <form id="join-form">\n          <div class="form-group">\n            <label>Room Code:</label>\n            <input type="text" id="room-code-input" placeholder="e.g., A3F9K2" required />\n          </div>\n          <div class="form-group">\n            <label>Your Name:</label>\n            <input type="text" id="player-name-input" placeholder="Enter your name" required />\n          </div>\n          <button type="submit" class="btn-primary">Join Room</button>\n        </form>\n      </div>\n      \n      <div id="game-area" style="display:none;">\n        <h2>Game in Progress</h2>\n        \n        <div id="player-identity" class="info-panel">\n          <strong>You are:</strong> <span id="your-player-name"></span>\n          <span id="host-indicator" style="display:none;" class="badge-host">HOST</span>\n        </div>\n        \n        <div id="turn-status" class="info-panel turn-indicator">\n          <strong id="turn-message">Waiting...</strong>\n        </div>\n        \n        <div id="status-message" class="status-message"></div>\n        \n        <div id="game-status" class="game-meta"></div>\n        \n        <div id="game-actions" class="action-buttons">\n          <button class="btn-action" id="action-play-card" disabled>Play Card</button>\n          <button class="btn-action" id="action-take-merchant" disabled>Take Merchant</button>\n          <button class="btn-action" id="action-claim-vp" disabled>Claim Points</button>\n          <button class="btn-action" id="action-rest" disabled>Rest</button>\n        </div>\n        \n        <div id="action-log" class="action-log">\n          <h3>Action Log</h3>\n          <div id="action-log-content"></div>\n        </div>\n      </div>\n    </div>\n  ',function(){document.querySelectorAll(".tab-btn").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-tab");t&&function(e){document.querySelectorAll(".tab-btn").forEach(e=>{e.classList.remove("active")}),document.querySelector(`[data-tab="${e}"]`)?.classList.add("active"),document.querySelectorAll(".tab-content").forEach(e=>{e.classList.remove("active")}),document.getElementById(`${e}-tab`)?.classList.add("active")}(t)})});const e=document.getElementById("create-form");e?.addEventListener("submit",c);const t=document.getElementById("join-form");t?.addEventListener("submit",l),document.getElementById("action-play-card")?.addEventListener("click",()=>u("play-card")),document.getElementById("action-take-merchant")?.addEventListener("click",()=>u("take-merchant")),document.getElementById("action-claim-vp")?.addEventListener("click",()=>u("claim-vp")),document.getElementById("action-rest")?.addEventListener("click",()=>u("rest"))}()):console.error("App mount point not found")}async function c(t){t.preventDefault();const n=document.getElementById("host-name-input").value.trim(),a=parseInt(document.getElementById("player-count").value);if(!n)return void alert("Please enter your name");const s=document.getElementById("room-info"),c=document.getElementById("room-code-display");if(s&&c)try{o=new e,o.on("room-created",({roomCode:e,hostPeerId:t,playerCount:n})=>{c.textContent=e;const a=document.getElementById("total-count");a&&(a.textContent=n.toString());const l=o.game;if(l&&l.players&&l.players.length>0){r=l.players[0].id,i=!0;const e=document.getElementById("your-player-name");e&&(e.textContent=l.players[0].name);const t=document.getElementById("host-indicator");t&&(t.style.display="inline-block")}d(),s.style.display="block"}),o.on("peer-connected",({playerName:e})=>{d()}),o.on("game-state-updated",e=>{const t=document.getElementById("game-area");if(t&&"PLAYING"===e.phase){const n=document.getElementById("room-info");n&&(n.style.display="none"),t.style.display="block",p(e)}}),o.on("action-processed",(e,t)=>{t?(y("Action processed successfully","success"),f(e,r)):y("Action processing failed","error")}),o.on("room-error",e=>{y(`Error: ${e.message}`,"error")});const t=[n,...Array.from({length:a-1},(e,t)=>`Player ${t+2}`)];await o.createRoom(t)}catch(l){alert(`Failed to create room: ${l.message}`)}}function d(){if(!o)return;const e=document.getElementById("player-list"),t=document.getElementById("connected-count");if(!e||!t)return;const n=o.game,a=o.playerConnections;if(!n)return;const r=new Set(Array.from(a.values()).map(e=>e.playerId));e.innerHTML=n.players.map((e,t)=>{const n=r.has(e.id),o=n?"Connected":"Waiting...",a=0===t?" (Host)":"";return`<div style="padding: 5px 0;">${n?"‚úÖ":"‚è≥"} ${e.name}${a} - ${o}</div>`}).join(""),t.textContent=r.size.toString()}async function l(e){e.preventDefault();const n=document.getElementById("room-code-input").value.trim().toUpperCase(),o=document.getElementById("player-name-input").value.trim();if(!n||!o)return void alert("Please fill in all fields");const s=`boardgame-${n.toLowerCase()}`;try{a=new t,a.on("connected",()=>{document.getElementById("create-tab").style.display="none",document.getElementById("join-tab").style.display="none";const e=document.getElementById("game-area");if(e){e.style.display="block";const t=document.getElementById("your-player-name");t&&(t.textContent=o),y(`Connected to room ${n}`,"success")}i=!1}),a.on("disconnected",()=>{y("Disconnected from room","error")}),a.on("host-disconnected",()=>{const e=document.getElementById("game-area");e&&(e.innerHTML='\n          <h2>Game Ended</h2>\n          <p style="padding: 20px; background: rgba(244, 67, 54, 0.2); border-radius: 8px;">\n            <strong>Host disconnected.</strong><br><br>\n            The host has closed their browser or lost connection.<br>\n            The game cannot continue without the host.<br><br>\n            Please refresh to start a new game.\n          </p>\n        ')}),a.on("game-state-received",e=>{p(e),f(null,r)}),a.on("action-accepted",e=>{y("Sending action to host...","info")}),a.on("action-rejected",(e,t)=>{y(`Invalid action: ${t}`,"error")}),a.on("error",e=>{y(`Error: ${e.message}`,"error")}),r=`player_${Date.now()}`,await a.joinRoomWithPeerId(n,s,r,o)}catch(c){alert(`Failed to join room: ${c.message}`)}}let m=!1;async function u(e){if(!m)if(r)if(!i||o)if(i||a)try{let t;switch(m=!0,document.querySelectorAll("#game-actions button").forEach(e=>{e.disabled=!0,e.classList.add("btn-disabled")}),e){case"rest":t={type:n.Rest,playerId:r,timestamp:Date.now()};break;case"play-card":return y("Select a card to play (UI not implemented)","error"),void(m=!1);case"take-merchant":return y("Select a merchant card (UI not implemented)","error"),void(m=!1);case"claim-vp":return y("Select a victory point card (UI not implemented)","error"),void(m=!1);default:return y("Unknown action type","error"),void(m=!1)}if(i){y("Processing action...","info");const e=o.processAction(t);e.valid?(y("Action processed successfully","success"),f(t,r)):y(`Invalid action: ${e.error}`,"error"),m=!1}else{if(!a)return y("Not connected to room","error"),void(m=!1);y("Sending action to host...","info"),await a.sendAction(t)}}catch(t){y(`Failed to send action: ${t.message}`,"error"),m=!1}else y("Not connected to a room","error");else y("Host room not initialized","error");else y("Player ID not set","error")}function p(e){const t=e.players[e.currentPlayerIndex],n=t?.id===r;e.players.find(e=>e.id===r);const o="FINISHED"===e.phase,a=document.getElementById("turn-message"),i=document.getElementById("turn-status");a&&i&&(o?(a.textContent="Game Over",i.className="info-panel turn-indicator turn-ended"):n?(a.textContent="YOUR TURN",i.className="info-panel turn-indicator turn-active"):(a.textContent=`Waiting for ${t?.name||"opponent"}`,i.className="info-panel turn-indicator turn-waiting"));const s=document.getElementById("game-status");s&&(s.textContent=`Turn ${e.turnNumber} ‚Ä¢ ${e.phase} ‚Ä¢ ${e.players.length} players`),function(e,t){const n=document.querySelectorAll("#game-actions button"),o=e&&!t&&!m;n.forEach(e=>{e.disabled=!o,o?e.classList.remove("btn-disabled"):e.classList.add("btn-disabled")})}(n,o),m=!1}function y(e,t){const n=document.getElementById("status-message");n&&(n.textContent=e,n.className=`status-message status-${t}`,n.style.display="block",setTimeout(()=>{n&&(n.style.display="none")},5e3))}const g=[],b=10;function f(e,t){if(!o)return;const a=o.game;if(a&&e){const t=a.players.find(t=>t.id===e.playerId),o=function(e,t){const o=new Date(e.timestamp).toLocaleTimeString();let a="";switch(e.type){case n.Rest:a="rested and took all cards back";break;case n.PlayMerchantCard:a="played a merchant card";break;case n.AcquireMerchantCard:a="acquired a merchant card";break;case n.ClaimPointCard:a="claimed a point card";break;default:a="performed an action"}return`[${o}] ${t} ${a}`}(e,t?.name||"Unknown");g.unshift(o),g.length>b&&g.pop(),function(){const e=document.getElementById("action-log-content");if(!e)return;0===g.length?e.innerHTML='<div class="log-empty">No actions yet</div>':e.innerHTML=g.map(e=>`<div class="log-entry">${e}</div>`).join("")}()}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):s();
//# sourceMappingURL=main-CY7hKdIj.js.map
