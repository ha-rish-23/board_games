{"version":3,"file":"main-L4ZzqXcY.js","sources":["../../src/main.ts"],"sourcesContent":["/**\r\n * Main Entry Point for Vite\r\n * \r\n * This file is the entry point referenced by index.html.\r\n * Vite will compile and bundle this TypeScript into browser-compatible JavaScript.\r\n */\r\n\r\nimport './main.css';\r\nimport { P2PGameRoom } from './p2p/browserRoom';\r\nimport { P2PGameClient } from './p2p/browserClient';\r\n\r\n// Global instances\r\nlet gameRoom: P2PGameRoom | null = null;\r\nlet gameClient: P2PGameClient | null = null;\r\n\r\n// Main application initialization\r\nfunction initApp() {\r\n  console.log('initApp called');\r\n  const app = document.getElementById('app');\r\n  \r\n  if (!app) {\r\n    console.error('App mount point not found');\r\n    return;\r\n  }\r\n  \r\n  console.log('App element found, rendering UI...');\r\n  \r\n  // Render UI\r\n  app.innerHTML = `\r\n    <div class=\"container\">\r\n      <h1>ðŸŽ® Century: Golem Edition</h1>\r\n      <p class=\"subtitle\">Peer-to-Peer Multiplayer - No Server Required</p>\r\n      \r\n      <div class=\"tabs\">\r\n        <button class=\"tab-btn active\" data-tab=\"create\">Create Room</button>\r\n        <button class=\"tab-btn\" data-tab=\"join\">Join Room</button>\r\n      </div>\r\n      \r\n      <div class=\"tab-content active\" id=\"create-tab\">\r\n        <h2>Create a Game Room</h2>\r\n        <form id=\"create-form\">\r\n          <div class=\"form-group\">\r\n            <label>Number of Players:</label>\r\n            <input type=\"number\" id=\"player-count\" min=\"2\" max=\"5\" value=\"3\" />\r\n          </div>\r\n          <button type=\"submit\" class=\"btn-primary\">Create Room</button>\r\n        </form>\r\n        <div id=\"room-info\" style=\"display:none;\">\r\n          <h3>Room Created!</h3>\r\n          <p>Share this room code with other players:</p>\r\n          <div class=\"room-code\" id=\"room-code-display\"></div>\r\n          <p>Share this peer ID:</p>\r\n          <div class=\"peer-id\" id=\"peer-id-display\"></div>\r\n        </div>\r\n      </div>\r\n      \r\n      <div class=\"tab-content\" id=\"join-tab\">\r\n        <h2>Join a Game Room</h2>\r\n        <form id=\"join-form\">\r\n          <div class=\"form-group\">\r\n            <label>Room Code:</label>\r\n            <input type=\"text\" id=\"room-code-input\" placeholder=\"e.g., A3F9K2\" />\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label>Host Peer ID:</label>\r\n            <input type=\"text\" id=\"host-peer-id-input\" placeholder=\"Provided by host\" />\r\n          </div>\r\n          <div class=\"form-group\">\r\n            <label>Your Name:</label>\r\n            <input type=\"text\" id=\"player-name-input\" placeholder=\"Enter your name\" />\r\n          </div>\r\n          <button type=\"submit\" class=\"btn-primary\">Join Room</button>\r\n        </form>\r\n      </div>\r\n      \r\n      <div id=\"game-area\" style=\"display:none;\">\r\n        <h2>Game in Progress</h2>\r\n        <div id=\"game-status\"></div>\r\n      </div>\r\n    </div>\r\n  `;\r\n  \r\n  console.log('UI rendered, setting up listeners...');\r\n  setupEventListeners();\r\n  console.log('App initialized successfully!');\r\n}\r\n\r\nfunction setupEventListeners() {\r\n  // Tab switching\r\n  const tabButtons = document.querySelectorAll('.tab-btn');\r\n  tabButtons.forEach(button => {\r\n    button.addEventListener('click', () => {\r\n      const tabName = button.getAttribute('data-tab');\r\n      if (tabName) {\r\n        switchTab(tabName);\r\n      }\r\n    });\r\n  });\r\n  \r\n  // Create room form\r\n  const createForm = document.getElementById('create-form');\r\n  createForm?.addEventListener('submit', handleCreateRoom);\r\n  \r\n  // Join room form\r\n  const joinForm = document.getElementById('join-form');\r\n  joinForm?.addEventListener('submit', handleJoinRoom);\r\n}\r\n\r\nfunction switchTab(tabName: string) {\r\n  // Update buttons\r\n  document.querySelectorAll('.tab-btn').forEach(btn => {\r\n    btn.classList.remove('active');\r\n  });\r\n  document.querySelector(`[data-tab=\"${tabName}\"]`)?.classList.add('active');\r\n  \r\n  // Update content\r\n  document.querySelectorAll('.tab-content').forEach(content => {\r\n    content.classList.remove('active');\r\n  });\r\n  document.getElementById(`${tabName}-tab`)?.classList.add('active');\r\n}\r\n\r\nasync function handleCreateRoom(event: Event) {\r\n  event.preventDefault();\r\n  \r\n  const playerCount = parseInt((document.getElementById('player-count') as HTMLInputElement).value);\r\n  const roomInfo = document.getElementById('room-info');\r\n  const codeDisplay = document.getElementById('room-code-display');\r\n  const peerDisplay = document.getElementById('peer-id-display');\r\n  \r\n  if (!roomInfo || !codeDisplay || !peerDisplay) return;\r\n  \r\n  try {\r\n    // Create P2P room\r\n    gameRoom = new P2PGameRoom();\r\n    \r\n    // Set up event listeners\r\n    gameRoom.on('room-created', ({ roomCode, hostPeerId }) => {\r\n      console.log('Room created:', roomCode, hostPeerId);\r\n      codeDisplay.textContent = roomCode;\r\n      peerDisplay.textContent = hostPeerId;\r\n      roomInfo.style.display = 'block';\r\n    });\r\n    \r\n    gameRoom.on('peer-connected', ({ peerId, playerName }) => {\r\n      console.log('Peer connected:', peerId, playerName);\r\n      alert(`Player ${playerName} joined the room!`);\r\n    });\r\n    \r\n    gameRoom.on('room-error', (error: Error) => {\r\n      console.error('Room error:', error);\r\n      alert(`Error: ${error.message}`);\r\n    });\r\n    \r\n    // Generate player names\r\n    const playerNames = Array.from({ length: playerCount }, (_, i) => `Player ${i + 1}`);\r\n    \r\n    // Create room\r\n    await gameRoom.createRoom(playerNames);\r\n    \r\n  } catch (error) {\r\n    console.error('Failed to create room:', error);\r\n    alert(`Failed to create room: ${(error as Error).message}`);\r\n  }\r\n}\r\n\r\nasync function handleJoinRoom(event: Event) {\r\n  event.preventDefault();\r\n  \r\n  const roomCode = (document.getElementById('room-code-input') as HTMLInputElement).value;\r\n  const hostPeerId = (document.getElementById('host-peer-id-input') as HTMLInputElement).value;\r\n  const playerName = (document.getElementById('player-name-input') as HTMLInputElement).value;\r\n  \r\n  if (!roomCode || !hostPeerId || !playerName) {\r\n    alert('Please fill in all fields');\r\n    return;\r\n  }\r\n  \r\n  try {\r\n    // Create P2P client\r\n    gameClient = new P2PGameClient();\r\n    \r\n    // Set up event listeners\r\n    gameClient.on('connected', () => {\r\n      console.log('Connected to room');\r\n      alert(`Successfully joined room ${roomCode}!`);\r\n      // Hide forms, show game area\r\n      document.getElementById('create-tab')!.style.display = 'none';\r\n      document.getElementById('join-tab')!.style.display = 'none';\r\n      const gameArea = document.getElementById('game-area');\r\n      if (gameArea) {\r\n        gameArea.style.display = 'block';\r\n        document.getElementById('game-status')!.textContent = `Connected as ${playerName}`;\r\n      }\r\n    });\r\n    \r\n    gameClient.on('disconnected', () => {\r\n      console.log('Disconnected from room');\r\n      alert('Disconnected from room');\r\n    });\r\n    \r\n    gameClient.on('game-state-received', (game) => {\r\n      console.log('Game state received:', game);\r\n      const statusEl = document.getElementById('game-status');\r\n      if (statusEl) {\r\n        statusEl.textContent = `Game Turn: ${game.turnNumber} | Phase: ${game.phase}`;\r\n      }\r\n    });\r\n    \r\n    gameClient.on('error', (error: Error) => {\r\n      console.error('Client error:', error);\r\n      alert(`Error: ${error.message}`);\r\n    });\r\n    \r\n    // Generate player ID\r\n    const playerId = `player_${Date.now()}`;\r\n    \r\n    // Join room\r\n    console.log('Joining room:', { roomCode, hostPeerId, playerId, playerName });\r\n    await gameClient.joinRoomWithPeerId(roomCode, hostPeerId, playerId, playerName);\r\n    \r\n  } catch (error) {\r\n    console.error('Failed to join room:', error);\r\n    alert(`Failed to join room: ${(error as Error).message}`);\r\n  }\r\n}\r\n\r\nfunction generateRoomCode(): string {\r\n  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';\r\n  let code = '';\r\n  for (let i = 0; i < 6; i++) {\r\n    code += chars.charAt(Math.floor(Math.random() * chars.length));\r\n  }\r\n  return code;\r\n}\r\n\r\n// Initialize when DOM is ready\r\nconsole.log('Script loaded, readyState:', document.readyState);\r\n\r\nif (document.readyState === 'loading') {\r\n  console.log('Waiting for DOMContentLoaded...');\r\n  document.addEventListener('DOMContentLoaded', () => {\r\n    console.log('DOMContentLoaded fired');\r\n    initApp();\r\n  });\r\n} else {\r\n  console.log('DOM already ready, initializing...');\r\n  initApp();\r\n}\r\n"],"names":["gameRoom","gameClient","initApp","console","log","app","document","getElementById","innerHTML","querySelectorAll","forEach","button","addEventListener","tabName","getAttribute","btn","classList","remove","querySelector","add","content","switchTab","createForm","handleCreateRoom","joinForm","handleJoinRoom","setupEventListeners","error","async","event","preventDefault","playerCount","parseInt","value","roomInfo","codeDisplay","peerDisplay","P2PGameRoom","on","roomCode","hostPeerId","textContent","style","display","peerId","playerName","alert","message","playerNames","Array","from","length","_","i","createRoom","P2PGameClient","gameArea","game","statusEl","turnNumber","phase","playerId","Date","now","joinRoomWithPeerId","readyState"],"mappings":"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"}